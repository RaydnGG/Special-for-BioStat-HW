---
title: "Zhurahov Maxim"
output: html_document
date: "2024-04-17"
---

# Задание 1

Пусть наш спонсор заинтересован, чтобы исследование имело 80% мощность, а уровень значимости — 5%, ожидаемый drop-out rate = 10%.

Рассчитайте выборку для исследования терапевтической эквивалентности для двухпериодного cross-over дизайна. Из предыдущих исследований известно, что дисперсия составляет 20% ( = 0.20), а разница средних составляет −10% (). Клиницисты сообщают нам, что клинически значимая разница составляет 25% ( = 0.25).

```{r}
# Расчет и установление параметров для всех задач
# Уровень значимости
alpha <- 0.05
# Значение beta
beta <- 0.2
# Drop out rate
drop_rate <- 0.1

# Находим z_alpha/2
z_alpha <- abs(qnorm(1 - alpha/2))
# Находим z_beta
z_beta <- abs(qnorm(beta))
```

```{r}
# Дисперсия
sd <- 0.20
# Разница средних
e <- 0.1
# Дельта
delta <- 0.25

# Рассчитываем выборку для исследования
top <- (z_alpha + z_beta)^2 * sd^2
bot <- 2 * (delta - abs(e))^2
sample_size <- top / bot

# Расчет с учетом дроарейта
final_sample_size <- sample_size / (1 - drop_rate)
# Округляем в большую сторону
halh_sample_size <- ceiling(final_sample_size)
total_sample_size <- halh_sample_size * 2
# Выводим результат
cat('Общий размер выборки:', total_sample_size)
```

# Задание 2

Рассчитайте выборку для гипотезы non-inferiority для двухвыборочного параллельного дизайна. Пусть клинически значимая разница  = -0.1, то есть мы ожидаем разницу не меньше 10%, а долю ответов для тестового препарата  = 0.65, в то время как нам известно из предыдущих исследований, что доля ответов у препарата сравнения составляет  = 0.85. Соотношение групп равно  = 1.

```{r}
# Доля ответов для препаратов
p1 <- 0.85
p2 <- 0.65
# Заданием клин знач дельту
delta <- -0.1

# Рассчитываем выборку для исследования
top <- (z_alpha + z_beta)^2 * (p1 * (1 - p1) + p2 *(1 - p2))
bot <- (p1 - p2 - delta)^2
sample_size <- nominator / denominator

# Учитываем drop-out rate
final_sample_size <- sample_size / (1 - drop_rate)
# Округляем в большую сторону
half_sample_size <- ceiling(final_sample_size)
total_sample_size <- half_sample_size * 2
# Выводим результат
cat('Общий размер выборки:', total_sample_size)
```

# Задание 3

 Рассчитайте выборку для гипотезы equality для следующего исследования. Мы хотим сравнить новую терапию инфекции, присоединяющейся в больничных условиях у пациентов с ожогами, с золотым стандартом, основываясь на данных, анализируемых с помощью регрессии Кокса. Пусть отношение рисков «золотой стандарт / новая терапия», hazard ratio, HR = 2. Мы предполагаем, что 80% пациентов ( = 0.8) могут столкнуться с этим заболеванием. Соотношения групп терапии равны (0.5).

```{r}
# Отношение рисков
risk <- 2
# Процент пациентов d
d <- 0.8
# Соотношение групп
p1 <- 0.5
p2 <- 0.5

# Рассчитываем выборку для исследования
top <- (z_alpha + z_beta)^2
bot <- (log(risk))^2 * p1 * p2 * d
sample_size <- top / bot

# Учитываем drop-out rate
final_sample_size <- sample_size / (1 - drop_rate)
# Округляем в большую сторону
half_sample_size <- ceiling(final_sample_size)
total_sample_size <- half_sample_size * 2
# Выводим результат
cat('Общий размер выборки n:', total_sample_size)
```
